(function(b){var a=b.$AlipayPage;var c={define:function(){Ext.define("Upload.sku.Panel",{extend:"Smartec.upload.Panel",model:"OperationHistory",id:"upform2",frame:true,autoHeight:true,border:0,bodyStyle:"padding: 10px 10px 0 10px;",labelWidth:40,items:[{xtype:"fileuploadfield",id:"form-file",name:"form-file",height:30,emptyText:"请选择文件...",fieldLabel:"选择文件",name:"upload",buttonCfg:{text:"",iconCls:"icon-upload"}},{xtype:"fieldset",title:"最新上传",margin:"5 5 5 5",width:350,height:150,defaultType:"displayfield",defaults:{layout:"vbox",border:false,bodyStyle:"padding:4px margin:4px",anchor:"-20"},items:[{fieldLabel:"上传文件",name:"fileName"},{fieldLabel:"上传时间",name:"operateTime",setValue:function(e){this.value=e;this.setRawValue(this.renderer(e));return this},renderer:function(e){if(e==null){return""}else{return Ext.Date.format(e,"Y-m-d H:i:s")}}},{fieldLabel:"上传用户",name:"operateOp"}]},{xtype:"fieldcontainer",items:[{border:0,buttons:[{text:"导入",handler:function(){var f=this.up("form").getForm();var e=f.findField("upload").getRawValue();if(""!=e){Ext.Ajax.request({url:path("/upload/validateSkuUploadCurrentOperation.json"),method:"post",dataType:"json",success:function(i,g){var h=Ext.decode(i.responseText);if(h.success){f.submit({url:path("/upload/doUploadSku.json"),method:"POST",success:function(k,j){Ext.Msg.alert("提示信息","文件成功上传");f.load({url:path("/operationHistory/lastedOperationLog.json?operationType=UPLOAD_SKU")})},failure:function(l,k){var j=Ext.decode(k.response.responseText);Ext.Msg.alert("提示信息","文件导入失败:"+j.result)},waitTitle:Ext.MessageBox.wait("正在导入，请等待...","提示")})}else{var h=Ext.decode(i.responseText);Ext.Msg.alert("提示信息",h.result)}},failure:function(h,g){Ext.Msg.alert("提示信息","请求失败,请稍后再试")}})}else{Ext.Msg.alert("提示信息","请选择导入文件！")}}},{text:"重置",handler:function(){this.up("form").getForm().findField("form-file").reset()}},{text:"解锁",handler:function(){Ext.Ajax.request({url:path("/sku/doDeleteSkuCurrentOperationByUser.json"),method:"post",dataType:"json",success:function(g,e){var f=Ext.decode(g.responseText);Ext.Msg.alert("提示信息",f.result)}})}}]}]}],initComponent:function(){var e=this;e.callParent();e.getForm().load({url:path("/operationHistory/lastedOperationLog.json?operationType=UPLOAD_SKU")})}})},create_form:function(){if(!this.upload_form){this.upload_form=Ext.create("Upload.sku.Panel",{id:"uploadForm"})}return this.upload_form},create_form:function(){if(!this.upload_form){this.upload_form=Ext.create("Upload.sku.Panel",{id:"uploadForm",reader:new Ext.data.JsonReader({root:"result",model:"OperationHistory",successProperty:"success"})})}return this.upload_form}};function d(){c.define();var e={createForm:function(){return c.create_form()}};return e}b.$AlipayPage=d()})(this);Ext.onReady(function(){var b=Ext.create("Ext.panel.Panel",{layout:"fit",height:"100%",defaults:{split:true},items:[{xtype:"panel",region:"center",items:$AlipayPage.createForm()}]});var a=Ext.create("Ext.tab.Panel",{id:"mainTab",activeTab:0,autoHeight:true,items:[{title:"SKU数据管理",layout:"fit",items:b}]});Ext.getCmp("center").add(a)});