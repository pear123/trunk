function converterOrderStatus(b,c,a){return messages["com.arvato.smartec.Constants.OrderStatus."+b+".message"]}function converterPayStatus(b,c,a){return messages["com.arvato.smartec.Constants.PayStatus."+b+".message"]}var warehouseNameIdStoreNew=Ext.create("Ext.data.Store",{fields:["label","value"],proxy:{type:"ajax",url:path("/omsWarehouse/addWarehouseNameList.json"),reader:{type:"json",root:"result"}},autoLoad:true});var orderTypeStore=Ext.create("Ext.data.Store",{fields:["label","value"],data:[{label:"混合订单",value:"BLEND_ORDER"},{label:"手工导入订单",value:"HANDWORK_CHANNEL_ORDER"},{label:"开票订单",value:"INVOICE_ORDER"},{label:"帮宝适订单",value:"PAMPERS_ORDER"},{label:"大宗促销订单",value:"BULK_PROMOTIONAL_ORDER"}]});Ext.define("Smartec.system.orderIdentify",{alias:"widget.orderIdentifyID",extend:"Smartec.grid.Panel",model:"OrderIdentifying",columns:[{text:"id",hidden:true,dataIndex:"omsOrderIdentifyingSysId"},{text:"订单标识名称",width:350,sortable:false,dataIndex:"identifyingName"},{text:"对应仓库",width:350,sortable:false,dataIndex:"wahehouseId"},{text:"创建时间",width:400,sortable:false,dataIndex:"createTime"},{text:"创建人",width:200,sortable:false,dataIndex:"createOp"}],addIdentifyHandle:function(){var a=this.up("gridpanel");if(Ext.getCmp("addIdentifyWindow")){Ext.getCmp("addIdentifyWindow").show()}else{Ext.create("Ext.Window",{title:"添加订单标识",width:500,height:200,layout:"fit",draggable:false,modal:true,id:"addIdentifyWindow",listeners:{hide:function(c){var b=Ext.getCmp("allform").getForm();b.clearInvalid();b.reset()}},closeAction:"hide",items:[allform=new Ext.form.FormPanel({id:"allform",bodyPadding:20,autoScroll:true,items:[{fieldLabel:"订单标识名称<span style=color:red>*</span>",xtype:"combo",id:"identifyingNameNew",name:"identifyingNameNew",store:orderTypeStore,width:400,displayField:"label",valueField:"value",editable:false,padding:"0 0 10 0",emptyText:"请选择订单标识...",emptyValue:"",allowBlank:false,blankText:"不能为空",autoShow:true},{fieldLabel:"对应仓库<span style=color:red>*</span>",xtype:"combo",id:"wahehouseIdNew",name:"wahehouseIdNew",store:warehouseNameIdStoreNew,width:400,displayField:"label",valueField:"value",editable:false,padding:"0 0 10 0",emptyText:"请选择仓库...",emptyValue:"",allowBlank:false,blankText:"不能为空",autoShow:true},{xtype:"button",text:"保存",iconCls:"icon-ok",handler:a.saveIdentify}]})]}).show()}},saveIdentify:function(){if(allform.form.isValid()){var b=Ext.getCmp("identifyingNameNew").getValue();var c=Ext.getCmp("wahehouseIdNew").getValue();var a=Ext.getCmp("identifyingNameNew").getRawValue();Ext.Ajax.request({url:path("/omsOrderIdentifying/saveOrderIdentify.json"),params:{identifyingName:a,identifyingCode:b,wahehouseId:c,flag:"save"},success:function(e){var f=Ext.decode(e.responseText);var d=f.result;if(d!=null){Ext.Msg.alert(messages["ext.tips.tip"],d,function(){})}else{Ext.Msg.alert(messages["ext.tips.tip"],"添加成功！",function(h){Ext.getCmp("addIdentifyWindow").hide();var g=Ext.getCmp("orderIdentifyID");g.getStore().load()})}},failure:function(){Ext.Msg.alert(messages["ext.tips.error"],messages["ext.tips.errorMsg"])}})}else{Ext.Msg.alert(messages["ext.tips.error"],"填写的内容有误！")}},editIdentifyHandle:function(){var b=this.up("gridpanel");var c=b.getSelectionModel();record=c.getSelection()[0];var a=record.get("omsOrderIdentifyingSysId");if(Ext.getCmp("editIdentifyWindow")){Ext.getCmp("editIdentifyWindow").show()}else{Ext.create("Ext.Window",{title:"修改订单标识",width:500,height:200,resizable:true,maximizable:true,autoScroll:true,modal:true,constrain:true,draggable:false,id:"editIdentifyWindow",items:[orderDetailTabPanel=Ext.create("Ext.panel.Panel",{autoScroll:true,layout:"fit",items:[Ext.create("Ext.form.Panel",{url:path("/omsOrderIdentifying/saveOrderIdentify.json?sysId="+a),id:"updateOrderIdentifying",padding:"0 0 0 20",reader:new Ext.data.JsonReader({root:"result",model:"OrderIdentifying",successProperty:"success"}),bodyPadding:20,border:0,items:[{fieldLabel:"订单标识名称",xtype:"displayfield",id:"identifyingName",name:"identifyingName",width:400,padding:"0 0 10 0"},{xtype:"textfield",hidden:true,id:"identifyingNameHide",name:"identifyingNameHide"},{xtype:"textfield",hidden:true,id:"identifyingCodeHide",name:"identifyingCodeHide"},{fieldLabel:"对应仓库<span style=color:red>*</span>",xtype:"combo",id:"wahehouseId",name:"wahehouseId",store:warehouseNameIdStore,width:400,displayField:"label",valueField:"value",editable:false,allowBlank:false,blankText:"不能为空",emptyText:"请选择仓库...",emptyValue:"",padding:"0 0 10 0"},{xtype:"fieldcontainer",layout:"hbox",items:[{xtype:"button",text:"保存",iconCls:"icon-ok",handler:function(){if(this.up("panel").getForm().isValid()){this.up("panel").getForm().submit({success:function(e,f){var d=f.result.result;if(d!=null){Ext.Msg.alert(messages["ext.tips.tip"],d,function(){})}else{Ext.Msg.alert(messages["ext.tips.tip"],"修改成功！",function(){b.getStore().load();Ext.getCmp("editIdentifyWindow").hide()})}},failure:function(){Ext.Msg.alert(messages["ext.tips.error"],messages["ext.tips.errorMsg"])}})}else{Ext.Msg.alert(messages["ext.tips.error"],"填写的内容有误!")}}}]}]})]})]}).show();Ext.getCmp("updateOrderIdentifying").getForm().load({url:path("/omsOrderIdentifying/getBySysId.json?sysId="+a),success:function(e,f){var d=f.result.data;Ext.getCmp("identifyingNameHide").setValue(d.identifyingName);Ext.getCmp("identifyingCodeHide").setValue(d.identifyingCode)}})}},initComponent:function(){orderGridMe=this;var a=this;a.topDockedItems=[{xtype:"button",itemId:"btnAdd",height:24,text:"添加订单标识",iconCls:"icon-new",handler:a.addIdentifyHandle},{xtype:"button",itemId:"btnEdit",disabled:true,height:24,text:"编辑订单标识明细",iconCls:"icon-edit",handler:a.editIdentifyHandle}];a.callParent();a.getSelectionModel().on("selectionchange",function(c,b){a.down("#btnEdit").setDisabled(!(b.length==1))})}});Ext.onReady(function(){Ext.create("Smartec.system.orderIdentify",{id:"orderIdentifyID"})});