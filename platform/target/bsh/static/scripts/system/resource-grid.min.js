function converterOrderStatus(b,c,a){return messages["com.arvato.smartec.Constants.OrderStatus."+b+".message"]}function converterPayStatus(b,c,a){return messages["com.arvato.smartec.Constants.PayStatus."+b+".message"]}Ext.define("Smartec.resource.ResourceGrid",{alias:"widget.resourcegrid",extend:"Smartec.grid.Panel",model:"Resource",columns:[{text:"id",dataIndex:"resourceSysId",hidden:true},{text:"资源名称",width:400,sortable:false,dataIndex:"resourceName"},{text:"资源定义",width:400,sortable:false,dataIndex:"resourcePattern"},{text:"资源状态",width:120,sortable:false,dataIndex:"resourceStatus"},{text:"资源描述",width:400,sortable:false,dataIndex:"resourceDescription"}],addResourceHandle:function(){var d=this.up("gridpanel");if(Ext.getCmp("addresourceWindow")){Ext.getCmp("addresourceWindow").show();var e=Ext.getCmp("allform").getForm();var a=e.getFields();e.reset();for(var c=0,b=a.length;c<b;c++){a.getAt(c).clearInvalid()}}else{Ext.create("Ext.Window",{title:"添加资源",width:600,height:300,autoScroll:true,modal:true,constrain:true,resizable:true,maximizable:true,id:"addresourceWindow",closeAction:"hide",items:[allform=new Ext.form.FormPanel({bodyPadding:20,id:"allform",items:[{fieldLabel:"资源名称 <span style=color:red>*</span>",xtype:"textfield",id:"resourceName",name:"resourceName",padding:"0 0 5 0",allowBlank:false,blankText:"不能为空",width:300,maxLength:50,maxLengthText:"最大长度不能超过50个字符!"},{xtype:"displayfield",value:"不超过50个字节（数字，字母和下划线组成 ）",padding:"0 0 5 0"},{fieldLabel:"资源定义 <span style=color:red>*</span>",xtype:"textfield",id:"resourcePattern",name:"resourcePattern",padding:"0 0 5 0",allowBlank:false,blankText:"不能为空",width:300,maxLength:1000,maxLengthText:"最大长度不能超过1000个字符!"},{xtype:"displayfield",padding:"0 0 5 0",value:"不超过1000个字符"},{fieldLabel:"资源描述",xtype:"textarea",id:"resourceDescription",name:"resourceDescription",width:500,height:80,maxLength:300,maxLengthText:"资源描述的长度不能超过300字符",padding:"0 0 5 0"},{xtype:"fieldcontainer",fieldLabel:"状态",width:300,defaultType:"radiofield",padding:"0 0 10 0",defaults:{flex:1},layout:"hbox",items:[{boxLabel:"启用",name:"size",inputValue:"1",id:"resourceStatus",checked:true},{boxLabel:"禁用",name:"size",inputValue:"0"}]},{xtype:"fieldcontainer",layout:"hbox",items:[{xtype:"button",text:"保存",iconCls:"icon-ok",handler:d.saveResource}]}]})]}).show()}},saveResource:function(){if(allform.form.isValid()){var b=Ext.getCmp("resourceName").getValue();var d=Ext.getCmp("resourcePattern").getValue();var a=Ext.getCmp("resourceDescription").getValue();var c=Ext.getCmp("resourceStatus").getGroupValue();Ext.Ajax.request({url:path("/resource/saveResource.do"),params:{resourceName:b,resourcePattern:d,resourceDescription:a,resourceStatus:c},success:function(e){var f=Ext.decode(e.responseText);if(f.result=="resourceNameError"){Ext.Msg.alert(messages["ext.tips.error"],"资源名称已存在！");return}else{if(f.result=="resourcePatternAndSystemError"){Ext.Msg.alert(messages["ext.tips.error"],"资源定义已存在！");return}else{if(f.result=="success"){Ext.Msg.alert(messages["ext.tips.tip"],"添加成功！",function(h){Ext.getCmp("addresourceWindow").hide();var g=Ext.getCmp("ResourceGridId");g.getStore().load()})}else{Ext.Msg.alert(messages["ext.tips.error"],"添加失败，请重试！")}}}},failure:function(){Ext.Msg.alert(messages["ext.tips.error"],messages["ext.tips.errorMsg"])}})}else{Ext.Msg.alert(messages["ext.tips.error"],"填写的内容有误！")}},editResourceHandle:function(){var b=this.up("gridpanel");var c=b.getSelectionModel();record=c.getSelection()[0];var a=record.get("resourceSysId");if(Ext.getCmp("editResourceWindow")){Ext.getCmp("editResourceWindow").show()}else{Ext.create("Ext.Window",{title:"修改角色",width:800,height:300,resizable:true,maximizable:true,autoScroll:true,modal:true,constrain:true,draggable:false,id:"editResourceWindow",items:[orderDetailTabPanel=Ext.create("Ext.panel.Panel",{autoScroll:true,border:0,items:[Ext.create("Ext.panel.Panel",{border:0,layout:"fit",items:[Ext.create("Ext.form.FormPanel",{url:path("/resource/updateResource.do"),id:"updateResource",padding:"0 0 0 20",reader:new Ext.data.JsonReader({root:"result",model:"Resource",successProperty:"success"}),bodyPadding:20,border:0,items:[{xtype:"textfield",hidden:true,name:"resourceSysId",id:"resourceSysId"+a},{xtype:"displayfield",hidden:true,id:"subSystemValue"+a,name:"subSystem"},{fieldLabel:"资源名称 <span style=color:red>*</span>",xtype:"textfield",id:"resourceName"+a,name:"resourceName",padding:"0 0 5 0",allowBlank:false,blankText:"不能为空",width:300,maxLength:50,maxLengthText:"最大长度不能超过50个字符!"},{xtype:"displayfield",value:"不超过50个字节（数字，字母和下划线组成 ）",padding:"0 0 5 0"},{fieldLabel:"资源定义 <span style=color:red>*</span>",xtype:"textfield",id:"resourcePattern"+a,name:"resourcePattern",padding:"0 0 5 0",allowBlank:false,blankText:"不能为空",width:300,maxLength:1000,maxLengthText:"最大长度不能超过1000个字符!"},{xtype:"displayfield",padding:"0 0 5 0",value:"不超过1000个字符"},{fieldLabel:"资源描述",xtype:"textarea",id:"resourceDescription"+a,name:"resourceDescription",width:500,height:80,maxLength:300,maxLengthText:"资源描述的长度不能超过300字符",padding:"0 0 5 0"},{xtype:"displayfield",hidden:true,id:"statusValue"+a,name:"resourceStatus"},{xtype:"fieldcontainer",fieldLabel:"状态",width:300,defaultType:"radiofield",padding:"0 0 10 0",defaults:{flex:1},layout:"hbox",items:[{boxLabel:"启用",name:"size"+a,inputValue:"1",id:"resourceStatusRadio1"+a,checked:true},{boxLabel:"禁用",name:"size"+a,inputValue:"0",id:"resourceStatusRadio2"+a}]},{xtype:"fieldcontainer",layout:"hbox",items:[{xtype:"button",text:"保存",iconCls:"icon-ok",handler:function(){if(this.up("panel").getForm().isValid()){this.up("panel").getForm().submit({success:function(d,f){var e=f.result;if(e.result=="success"){Ext.Msg.alert(messages["ext.tips.tip"],"修改成功！",function(g){b.getStore().load();Ext.getCmp("editResourceWindow").close()})}else{if(e.result=="resourceNameError"){Ext.Msg.alert(messages["ext.tips.error"],"资源名称已存在！");return}else{if(e.result=="resourcePatternAndSystemError"){Ext.Msg.alert(messages["ext.tips.error"],"该子系统下资源定义已存在！");return}}}},failure:function(){Ext.Msg.alert(messages["ext.tips.error"],"修改失败，请重试！")}})}else{Ext.Msg.alert(messages["ext.tips.error"],"填写的内容有误!")}}}]}]})]})]})]}).show()}Ext.getCmp("updateResource").getForm().load({url:path("/resource/resourceById.json?sysId="+a),success:function(e,f){var d="";d=Ext.getCmp("statusValue"+a).getValue();var h=Ext.getCmp("resourceStatusRadio1"+a);var g=Ext.getCmp("resourceStatusRadio2"+a);if(d=="1"){h.setValue(true);return}if(d=="0"){g.setValue(true);return}}})},initComponent:function(){orderGridMe=this;var a=this;a.topDockedItems=[{xtype:"button",itemId:"btnAdd",height:24,text:"添加资源",iconCls:"icon-new",handler:a.addResourceHandle},{xtype:"button",itemId:"btnEdit",disabled:true,height:24,text:"编辑资源明细",iconCls:"icon-edit",handler:a.editResourceHandle}];a.callParent();a.getSelectionModel().on("selectionchange",function(c,b){a.down("#btnEdit").setDisabled(!(b.length==1))})}});Ext.onReady(function(){Ext.create("Smartec.resource.ResourceGrid",{id:"ResourceGridId"})});